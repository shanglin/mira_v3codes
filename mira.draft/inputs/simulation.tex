\section{Simulation of M33 observations} \label{sec.simulation}

To build models for searching Miras from the M33 observations, we simulated Mira and Non-Mira light curves as training data. The simulated light curve includes Miras, constant stars, and semiregular variable stars (SRVs). Upon the simulated light curves, we calculated the variability index and kept those with $L>0.6$. The number of light curves was chosen to match real observations, other properties such as sampling patterns and measurement uncertainties were also derived from the M33 observations. Below we describe the simulations of different kind of light curves.

\subsection{Mira light curves}
We simulated 5,000 Mira light curves for as part of the training data. The simulation method is similar to that in \red{(cite GP)}, which applies the sampling patterns and noise levels of the M33 observations to LMC Mira light curves from the OGLE observations. The samping patterns we used in this paper is silightly different from those in \red{(cite GP)} because we removed some noisy frames of the M33 observations from analysis. Here we briefly describe the method we used to simulate Mira light curves.

We generated templated LMC Mira light curves based on the OGLE observations, and derived their occurrence in the M33 observations. The LMC Miras can be considered as a complete sample and are well observed, with a baseline longer than 7.5 years and hundreds of observations at relatively small uncertainty. However, the light curves are by no means continuous, which are needed for simulating sparsely observed light curves at given sampling patterns. To obtain continuous Mira templates, we used the \red{(model name)} to fit the LMC Mira light curves and predict their magnitude at any given time inside their time domain. We then shifted the template light curves by $+6.2$ magnitude to account for the distance difference between LMC and M33. For the M33 observations, most faint Miras can not be dectected. We used the completeness functions of the M33 observations derived in \red{(cite GP)} as occurrence rate of the template light curves.

The sampling patterns were randomly selected from the light curves of M33 observations. We shifted the observation dates of the templates by some random amount to cover the selected M33 sampling dates. The random shifts made the simulated light curves different from each other, even when the same template and same sampling pattern were used.

The magnitude uncertainties of the M33 observations are quite different from the LMC light curves due to differences in overall appearent magnitude and in configurations of telescopes. To simulate the noise level of the M33 observations, we fit the relations between magnitude uncertainty $\sigma$ and appearent magnitude $m$ with the following empirical function for each frame of the M33 observations
\begin{equation}
\sigma(t_i,f_k) = a(t_i,f_k)^{[m-b(t_i,f_k)]} + c(t_i,f_k)\,, \label{equ.sigma.mag}
\end{equation}
where $a$, $b$, and $c$ are free parameters and varies with frames identified by time $t_i$ and field $f_k$. The magnitude uncertainties of simulated light curves were determined by Equation~\ref{equ.sigma.mag} and normally distributed noises with standard deviations $\sigma(t_i,f_k)$ were added to the simulated light curves.

\subsection{Constant star light curves}

We simulated $\sim 5\times 10^5$ light curves for constant stars, which matches the number of observed stars in M33. For the M33 observations, the magnitude uncertainties reported by the photometry software were sometimes either under-estimated or over-estimated. Since both the $L$ index and the Mira periodogram utilize the the value of magnitude uncertainties, we took the inaccuracy of reported magnitude uncertainties into account for the simulated light curves. For constant stars the inaccuracy of uncertainties can be described by
\begin{equation}
\chi_\nu^2 = \frac{1}{\sqrt{n-1}}\sum_{i=1}^n\frac{(m_i-\bar m)^2}{\sigma_i^2}\,,
\end{equation}
where $n$ is the number of observations. Figure~\ref{fig.chi.dist.example} shows the distribution of $\chi_\nu^2$ as a function of magnitude for all stars in one field of the M33 observations.

For each star in the M33 observations, we calculated the mean magnitude and $\chi_\nu^2$ by assuming that it is a constant star. To simulate a light curve, the magnitude of each epoch $m_i$ was sampled from a normal distribution
\begin{equation}
m_i = \mathcal{N}(\bar m,\sqrt{\chi_\nu^2}\cdot\sigma_i)\,,
\end{equation}
where $\sigma_i$ is the reported magnitude uncertainty for the $i$th epoch. We also shuffled the sampling pattern by randomly selecting $n$ time points from all the valid epochs of the corresponding field. The magnitude uncertainties $\{\sigma_i\}$ kept unchanged for the simulated light curve. In this way the simulated light curves gave the same inaccuracy of magnitude uncertainties as teh real light curves. The similarity between the distribution of $\chi_\nu^2$ for the simulated light curves and that of the real M33 light curves illustrated this consistency (Figure~\ref{fig.chi.dist.example}). \red{An example of the simulated constant star light curve is given in Figure~\ref{fig.const.flc.example}.}


% For each star in the M33 observations, we calculated $\chi_\nu^2$ by assuming that it is a constant star. A sampling pattern was then randomly selected from the true light curves in the same field, and the ``reported uncertainty'' of each epoch was derived based on Equation~\ref{equ.sigma.mag} individually. Finally the simulated magnitude of each epoch was sampled the normal distribution
% \begin{equation}
% m = \mathcal{N}(m_0,\sqrt{\chi_\nu^2}\cdot\sigma)\,,
% \end{equation}
% where $m_0$ is the magnitude of that star. The simulated magnitude uncertainty was still set to $\sigma$ from Equation~\ref{equ.sigma.mag}. In this way the simulated light curves give the same inaccuracy of magnitude uncertainties as the real light curves. An example of simulated constant star light curve is given in Figure~\ref{fig.const.flc.example}.



We note that the assumption of all stars in the M33 observations being constant stars is not correct generally, because there should be some variable stars among them. But the amount of variable stars are small relative to the entire sample of stars. An advantage of this method is that stars of bad photometry results, which may be due to bad pixels or frame edges, were also simulated.


\begin{figure}
\epsscale{1}
\plotone{figures.include/chi_dist_example.eps}
\caption{$\chi_\nu^2$ as a function of instrumental $I$-band magnitude for one field. The depth of color is in log scale of number of stars in each pixel. The blue dashed line indicates the position of $\chi_\nu^2=1$.}\label{fig.chi.dist.example}
\end{figure}

\begin{figure}
\epsscale{1}
\plotone{figures.include/const_flc_example.eps}
\caption{An example of simulated constant star light curve (lower) and its corresponding real light curve (upper). The errorbars for the simulated light curve indicate the ``reported uncertainties'', which were rescaled before adding noise the light curve.}\label{fig.const.flc.example}
\end{figure}

\subsection{SRV light curves}

SRVs share some similarities with Miras, and thus may increase the misclassification rate for M33 Mira search. Although SRV light curves are more chaotic and non-periodic than Mira light curves, the magnitudes and the amount of magnitude variations for some SRVs are compariable to Miras. Due to the sparse nature of the M33 observations, some SRVs in M33 may be misclassified as Miras. To improve the ability of discriminating SRVs and Miras, we included simulated SRV light curves in the training data. This would also help us to assess the misclassification rate.

We simulated 5000 SRV light curves with the approach similar to the simulation of Mira light curves. The only difference is that we smooth splined the LMC SRV light curves to obtain template SRV light curves.
